/* jQuery flip clock plugin - https://github.com/andysellick/flipclock */
!function(t,e){var i=function(t,i){this.elem=t,this.$elem=e(t),this.options=i};i.prototype={init:function(){var i=this;i.units=["second","minute","hour","day","month","year"],i.time={year:0,month:0,day:0,hour:0,minute:0,second:0},i.prevtime={year:0,month:0,day:0,hour:0,minute:0,second:0},i.timelimits={year:1e4,month:11,day:366,hour:23,minute:59,second:59},i.timer=0,i.trigger=0,i.endofdays=0,i.timeZoneOffset=0,this.settings=e.extend({mode:"counter",showUnits:!0,showAllDigits:!1,targetDate:[2e3,1,1,0,0,0],stopAtZero:!1,timeZoneOffset:-1},this.defaults,this.options);var n={general:{overrideSettings:function(){var t=i.settings.targetDate.length;if(t<6)for(;t<6;t++)i.settings.targetDate.push(0);var e=i.settings.targetDate;if(i.settings.targetDate=new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5]),-1!==i.settings.timeZoneOffset){var n=new Date;n=n.getTimezoneOffset(),i.timeZoneOffset=36e5*(n/60+i.settings.timeZoneOffset)}},initElements:function(){i.$elem.html("").addClass("flipclock");var t=1;if("clock"===i.settings.mode){i.settings.targetDate=[2e3,1,1,0,0,0,0];var e=new Date;i.time.second=e.getSeconds(),i.time.minute=e.getMinutes(),i.time.hour=e.getHours()+i.timeZoneOffset,t=Math.floor(i.units.length/2-1)}else t=i.units.length-1;for(var s=t;s>-1;s--)n.markup.generateDigit(n.general.padDigits(i.time[i.units[s]],2),i.units[s]);n.general.backupTime(),i.settings.stopAtZero?n.markup.showDigit("second"):n.general.initCounter(),i.settings.showAllDigits&&i.$elem.find(".flipclock__unit").addClass("flipclock__unit--visible")},getTimeNowTarget:function(){n.general.backupTime(),n.general.resetTime();var t=Date.now()+i.timeZoneOffset,e=moment.preciseDiff(t,i.settings.targetDate);if((e=e.split(" ")).length>1){i.endofdays=0;for(var s=0;s<e.length;s+=2){var a=e[s],r=e[s+1];"s"==r[r.length-1]&&(r=r.substring(0,r.length-1)),i.time[r]=a}}else i.endofdays=1,i.settings.stopAtZero&&(i.trigger.remove(),clearTimeout(i.timer))},initCounter:function(){i.trigger=e("<div/>").addClass("flipclock__trigger").attr("data-id","trigger").appendTo(i.$elem);var t=1;setTimeout(function(){for(;t;)Date.now()%1e3==0&&(t=0,i.trigger.addClass("flipclock__trigger--active"))},1),i.transitionEvent=function(){var t,e=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in i)if(void 0!==e.style[t])return i[t]}(),i.trigger.on(i.transitionEvent,function(t){clearTimeout(i.timer),i.timer=setTimeout(function(){n.general.doCounter(),i.trigger.hasClass("flipclock__trigger--active")?i.trigger.removeClass("flipclock__trigger--active"):i.trigger.addClass("flipclock__trigger--active")},0)})},doCounter:function(){n.general.getTimeNowTarget();for(var t=0,e=i.units.length-1;e>=0;e--)n.general.updateDigit(i.units[e]),t?n.markup.showDigit(i.units[e]):0===i.time[i.units[e]]&&0===i.prevtime[i.units[e]]&&"second"!==i.units[e]?n.markup.hideDigit(i.units[e]):(t=1,n.markup.showDigit(i.units[e]));n.general.backupTime()},updateDigit:function(t){var s=t,a=parseInt(i.time[t]);1!=a&&(s+="s");var r=i.prevtime[t];a=n.general.padDigits(a,2),r=n.general.padDigits(r,2);var o=i.$elem.find(".flipclock__unit[data-name="+t+"]"),l=o.find(".flipclock__digits").attr("data-next",a).attr("data-now",r);l.find(".flipclock__digits-next").remove(),l.find(".flipclock__digits-prev").remove(),e("<div/>").addClass("flipclock__digits-next").html(a).appendTo(l),e("<div/>").addClass("flipclock__digits-prev").html(r).appendTo(l),l.find(".number").html(a),i.settings.showUnits&&o.find(".flipclock__units").html(s),i.time[t]!==i.prevtime[t]?l.attr("class","flipclock__digits flipclock__digits--animate"):l.attr("class","flipclock__digits")},backupTime:function(){for(var t in i.time)i.prevtime[t]=i.time[t]},resetTime:function(){i.time={year:0,month:0,day:0,hour:0,minute:0,second:0}},getNumberStrLen:function(t){return(""+t).length},padDigits:function(t,e){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}},markup:{generateDigit:function(t,n){var s=e("<div/>").attr("data-name",n).addClass("flipclock__unit"),a=e("<div/>").addClass("flipclock__digit").appendTo(s),r=e("<div/>").addClass("flipclock__digits").attr("data-now",t).appendTo(a);e("<span/>").addClass("number").html(t).appendTo(r),i.settings.showUnits&&e("<div/>").addClass("flipclock__units").html(n).appendTo(s),s.appendTo(i.$elem)},showDigit:function(t){i.$elem.find(".flipclock__unit[data-name="+t+"]").addClass("flipclock__unit--visible")},hideDigit:function(t){i.settings.showAllDigits||i.$elem.find(".flipclock__unit[data-name="+t+"]").removeClass("flipclock__unit--visible")}}};e(t).on("load",function(){n.general.overrideSettings(),n.general.initElements()})}},e.fn.flipclock=function(t){return this.each(function(){new i(this,t).init()})},t.Plugin=i}(window,jQuery);
